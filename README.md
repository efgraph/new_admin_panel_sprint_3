# Заключительное задание первого модуля

Ваша задача в этом уроке — загрузить данные в Elasticsearch из PostgreSQL. Подробности задания в папке `etl`.


Состояние хранится в папке etl/storage, на него завязаны запуск тестов и индексирование elasticsearch.
При запуске создается юзер admin/admin.

Подскажите пожалуйста, как можно организовать бесконечное обновление эластика основываясь только на поле updated_at?
Т.е. есть у нас в файле(state) отсечка времени, мы индексируем записи в базе, те что имеют больший или меньший updated_at?
В теории указано, что больший (WHERE fw.modified > ‘<время>’). Т.е. проиндексировали elastic,
сдвинули timestamp из state вперед и ждем новых пополнений из админки. Это работать будет, если одним запросом всей базе обновим modified,
а если как требуется в задании батчами (по 100 записей например) то получается бесконечный цикл.
Че-то не могу додуматься как этот алгоритм реализовать без дополнительного флага в базе, как это сейчас реализовано.
Остальные замечания поисправлял.